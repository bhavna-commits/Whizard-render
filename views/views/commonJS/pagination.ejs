<script>
	// Get current URL without any page query parameter
	const pageurl = new URL(window.location.href);
	// pageurl.searchParams.delete('page'); // Removing the page param to append it later dynamically

	// Navigate to the desired page number
	function goToPage (page) {
		const totalPages = <%= totalPages %>;
		if (page > totalPages) {
			alert("Page doesn't exist. Try a lower number.");
			pageInput.value = <%= page %>; // Reset input to the current page
		} else if (page < 1) {
			alert("Page number should be at least 1.");
			pageInput.value = <%= page %>;
		} else {
			pageurl.searchParams.set('page', page);
			window.location.href = pageurl.toString();
		}
	}
	
	// Handling Go button for input field
	function goToInputPage () {
		const pageInput = document.getElementById('pageInput');
		const page = parseInt(pageInput.value);
		goToPage(page);
	}
</script>

<div class="flex items-center justify-center py-2 space-x-4">
	<nav class="flex items-center">
		<ul class="flex space-x-1">
			<!-- Previous Button -->
			<li>
				<a href="<%= page > 1 ? 'javascript:void(0)' : '#' %>" class="px-3 py-2 rounded-md text-sm font-medium border border-gray-300 hover:no-underline 
					<%= page == 1 ? 'hover:cursor-not-allowed bg-gray-200 text-white' : 'text-gray-500 hover:bg-gray-50' %>" onclick="goToPage(<%= page - 1 %>)">‹</a>
			</li>
			
			<!-- First Page Button -->
			<li>
				<a href="javascript:void(0)" class="px-3 py-2 rounded-md text-sm font-medium <%= page === 1 ? 'text-red-600 border-red-600 border-2' : 'text-gray-700 border-2 border-gray-300 hover:bg-gray-50' %>" onclick="goToPage(1)">1</a>
			</li>
			
			<% if (page > 3) { %>
			<!-- Show "..." if current page is greater than 3 -->
			<li><span class="px-3 py-2 text-sm text-gray-500">...</span></li>
			<% } %>
			
			<!-- Dynamic Page Numbers based on current page -->
			<% for (let i = Math.max(2, page - 1); i <= Math.min(totalPages - 1, page + 1); i++) { %>
			<li>
				<a href="javascript:void(0)" class="px-3 py-2 rounded-md text-sm font-medium <%= i === page ? 'text-red-600 border-red-600 border-2' : 'text-gray-700 border-2 border-gray-300 hover:bg-gray-50' %>" onclick="goToPage(<%= i %>)"><%= i %></a>
			</li>
			<% } %>
			
			<% if (page < totalPages - 2) { %>
			<!-- Show "..." if there are more pages -->
			<li><span class="px-3 py-2 text-sm text-gray-500">...</span></li>
			<% } %>
			
			<!-- Last Page Button -->
			<% if (totalPages > 1) { %>
			<li>
				<a href="javascript:void(0)" class="px-3 py-2 rounded-md text-sm font-medium <%= page === totalPages ? 'text-red-600 border-red-600 border-2' : 'text-gray-700 border-2 border-gray-300 hover:bg-gray-50' %>" onclick="goToPage(<%= totalPages %>)"><%= totalPages %></a>
			</li>
			<% } %>
			
			<!-- Next Button -->
			<li>
				<a href="<%= page < totalPages ? 'javascript:void(0)' : '#' %>" class="px-3 py-2 rounded-md text-sm font-medium border border-gray-300 hover:no-underline 
					<%= page == totalPages ? 'hover:cursor-not-allowed bg-gray-200 text-white' : 'text-gray-500 hover:bg-gray-50' %>" onclick="goToPage(<%= page + 1 %>)">›</a>
			</li>
		</ul>
	</nav>
	
	<!-- "Go to page" input -->
	<div class="flex items-center space-x-2">
		<span class="text-sm text-gray-700">Go to page</span>
		<input type="number" min="1" max="<%= totalPages %>" class="w-16 px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500" value="<%= page %>" id="pageInput" />
		<button type="button" class="px-3 py-1 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2" onclick="goToInputPage()">Go</button>
	</div>
</div>