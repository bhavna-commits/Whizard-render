<html>

<head>
	<title>Campaign Report</title>
</head>

<body style="background-color: #f4f7fc; font-family: Arial, sans-serif; padding: 20px;">
	<div style="max-width: 600px; margin: auto; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
		<!-- Header with logo -->
		<div style="text-align: center; padding: 20px 0;">
			<img src="cid:whizz_logo" alt="Whizz Logo" style="max-width: 150px;" />
		</div>
		
		<!-- Overview Stats -->
		<div style="padding: 20px; border-bottom: 1px solid #eee;">
			<h2 style="color: #333; text-align: center; margin-bottom: 20px;">Campaign Report Overview</h2>
			<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px;">
				<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
					<h3 style="margin: 0 0 5px 0; color: #666;">Total</h3>
					<p style="margin: 0; font-size: 24px; font-weight: bold; color: #333;"><%= totalMessages %></p>
				</div>
				<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
					<h3 style="margin: 0 0 5px 0; color: #666;">Sent</h3>
					<p style="margin: 0; font-size: 24px; font-weight: bold; color: #333;"><%= messagesSent %> <span style="font-size: 14px; color: #666;">(<%= percentSent %>% of target)</span></p>
				</div>
				<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
					<h3 style="margin: 0 0 5px 0; color: #666;">Delivered</h3>
					<p style="margin: 0; font-size: 24px; font-weight: bold; color: #333;"><%= messagesDelivered %> <span style="font-size: 14px; color: #666;">(<%= percentDelivered %>% of target)</span></p>
				</div>
				<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
					<h3 style="margin: 0 0 5px 0; color: #666;">Read</h3>
					<p style="margin: 0; font-size: 24px; font-weight: bold; color: #333;"><%= messagesRead %> <span style="font-size: 14px; color: #666;">(<%= percentRead %>% of target)</span></p>
				</div>
				<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
					<h3 style="margin: 0 0 5px 0; color: #666;">Replies</h3>
					<p style="margin: 0; font-size: 24px; font-weight: bold; color: #333;"><%= messagesReplied %></p>
				</div>
				<div style="background: #ffe0e0; padding: 15px; border-radius: 8px; text-align: center;">
					<h3 style="margin: 0 0 5px 0; color: #666;">Failed</h3>
					<p style="margin: 0; font-size: 24px; font-weight: bold; color: #333;"><%= messagesFailed %></p>
				</div>
			</div>
		</div>
		
		<!-- Campaign Details Table -->
		<% if (campaigns.length > 0) { %>
		<div style="padding: 20px;">
			<table style="width: 100%; border-collapse: collapse;">
				<thead>
					<tr style="background-color: #f8f9fa;">
						<th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">Send Date</th>
						<th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">Status</th>
						<th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">Name</th>
						<th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">Contact</th>
						<th style="padding: 12px; text-align: left; border-bottom: 2px solid #eee;">Message Sent</th>
					</tr>
				</thead>
				<tbody>
					<% campaigns.forEach(report => { %>
					<tr style="border-bottom: 1px solid #eee;">
						<td style="padding: 12px;"><%= new Date(report.timestamp * 1000 || report.updatedAt * 1000).toLocaleDateString() %></td>
						<td style="padding: 12px;">
							<span style="padding: 4px 8px; border-radius: 4px; background-color: <%= report.statusBgColor %>; color: <%= report.statusTextColor %>;">
								<%= report.status.charAt(0).toUpperCase() + report.status.slice(1).toLowerCase() %>
							</span>
						</td>
						<td style="padding: 12px;"><%= report.contactName %></td>
						<td style="padding: 12px;">
							<% const maskedPhone = report.recipientPhone.slice(0, -2).replace(/\d/g, 'X') + report.recipientPhone.slice(-2) %>
							<%= maskedPhone %>
						</td>
						<td style="padding: 12px; max-width: 300px;"><%= report.messageTemplate || 'No Message Text Available' %></td>
					</tr>
					<% }) %>
				</tbody>
			</table>
		</div>
		<% } else { %>
		<div style="padding: 20px; text-align: center; color: #666;">
			<p>No reports available for this campaign.</p>
		</div>
		<% } %>
		
		<!-- Footer -->
		<div style="background-color: #f8f9fa; padding: 20px; text-align: center; border-top: 1px solid #eee;">
			<p style="margin: 0; color: #999; font-size: 12px;">
				This is an automated report from Whizz. Please do not reply to this email.
			</p>
		</div>
	</div>
</body>

</html>