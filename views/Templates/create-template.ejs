<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
	<meta charset="utf-8" />
	<title>Whizard - Create Template</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no" />
	<link rel="apple-touch-icon" href="pages/ico/60.png" />
	<link rel="apple-touch-icon" sizes="76x76" href="pages/ico/76.png" />
	<link rel="apple-touch-icon" sizes="120x120" href="pages/ico/120.png" />
	<link rel="apple-touch-icon" sizes="152x152" href="pages/ico/152.png" />
	<link rel="icon" type="image/x-icon" href="favicon.ico" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-touch-fullscreen" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="default" />
	<meta content="Meet pages - The simplest and fastest way to build web UI for your dashboard or app." name="description" />
	<meta content="Ace" name="author" />
	<link href="assets/plugins/pace/pace-theme-flash.css" rel="stylesheet" type="text/css" />
	<link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
	<!-- <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" /> -->
	<link href="assets/plugins/jquery-scrollbar/jquery.scrollbar.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="assets/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" media="screen" />
	<!-- <link class="main-stylesheet" href="pages/css/themes/corporate.css" rel="stylesheet" type="text/css" /> -->
	<!-- Please remove the file below for production: Contains demo classes -->
	<link class="main-stylesheet" href="assets/css/style.css" rel="stylesheet" type="text/css" />
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	<link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
	<script src="https://viralpitch.co/insights/app/js/apexcharts-bundle/dist/apexcharts.js"></script>
	<link rel="stylesheet" href="styles/template.css" />
	<link rel="stylesheet" href="https://viralpitch.co/insights/app/js/apexcharts-bundle/dist/apexcharts.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
	<link href="styles/style.css" rel="stylesheet" type="text/css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" type="text/css" href="styles/template-preview.css" />
	<style>
		* {
			font-family: "Figtree", sans-serif;
			font-optical-sizing: auto;
		}
		
		button.active {
			background-color: #ddd;
			border-color: #333;
		}
		
		#bodyInput * {
			font-size: inherit;
			font-family: inherit;
			line-height: inherit;
		}
		
		#previewContainer {
			overflow-wrap: break-word;
			/* Ensures that long words will wrap */
			word-wrap: break-word;
			/* Legacy support for older browsers */
			word-break: break-word;
			/* Break long words at arbitrary points if necessary */
		}
		
		#previewHeader,
		#previewBody,
		#previewFooter,
		#previewButtons {
			overflow-wrap: break-word;
			/* Wrap long words */
			word-wrap: break-word;
			word-break: break-word;
			white-space: normal;
			/* Ensure text can break onto a new line */
		}
	</style>
	<!-- Font Awesome link -->
</head>
<!-- Loader HTML -->
<%- include("../commonJS/loader") %>

<body class="">
	
	
	<div class="layout-container">
		<%- include("../commonJS/sidebar")  %>
		
		<div class="flex bg-slate-50 flex-grow w-full max-h-full overflow-auto">
			<div class="bg-white px-3 ml-1 py-3 min-w-[22rem] flex-shrink">
				<div class="title logo w-full">
					<h4 class="page-title font-bold text-xl text-center">
						Add template
					</h4>
				</div>
				
				<form class="space-y-1 mt-5">
					<div class="form-group  space-y-1">
						<label class="font-semibold">Template Name</label>
						<input type="text" placeholder="Give new template a name" class="form-control placeholder:text-gray-400 border-1 text-sm" required />
					</div>
					
					<div class="form-group  space-y-1">
						<label class="font-semibold">Category</label>
						<div class="relative">
							<button id="categoryButton" aria-haspopup="true" aria-expanded="false" class="w-full text-sm bg-transparent border border-gray-300 form-control px-2 py-2 text-left cursor-pointer text-gray-400 focus:outline-none focus:ring-2  focus:ring-indigo-200 " type="button">
								Choose category
							</button>
							<div id="categoryDropdown" class="hidden absolute bg-white border border-gray-200 rounded mt-2 py-2 shadow-lg w-full z-50">
								<div class="block cursor-pointer px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="selectCategory('Marketing')">Marketing</div>
								<div class="block px-4 cursor-pointer py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="selectCategory('Utility')">Utility</div>
								<div class="block px-4 py-2 text-sm text-gray-700 cursor-pointer hover:bg-gray-100" onclick="selectCategory('Authentication')">Authentication</div>
							</div>
						</div>
					</div>
					<div class="relative mt-3 w-full">
						<label for="language" class="block font-semibold ">Select Language</label>
						
						<div class="relative mt-3">
							<!-- Trigger button for dropdown -->
							<button type="button" id="language-button" onclick="toggleLanguageDropdown()" class="block form-control w-full px-2 py-2 border border-gray-300 bg-white rounded-[.6rem] focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm text-left text-gray-400">
								Select a language
							</button>
							
							<!-- Dropdown content -->
							<div id="dropdown-menu" class="hidden absolute z-10 w-full bg-white border border-gray-300 rounded-[.6rem] shadow-lg mt-1">
								<!-- Search input inside the dropdown -->
								<input type="text" id="language-search" onkeyup="filterLanguages()" placeholder="Search languages..." class="block w-full p-3 border border-gray-300 rounded-[.6rem] focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" />
								
								<!-- Dropdown options (initially hidden) -->
								<ul id="language-options" class="max-h-48 overflow-y-auto">
									<% languagesCode.forEach(language => { %>
									<li class="hover:bg-indigo-300 hover:text-white px-4 py-2 cursor-pointer rounded" onclick="selectLanguage('<%= language.language %>', '<%= language.code %>')">
										<%= language.language %>
									</li>
									<% }); %>
								</ul>
							</div>
						</div>
					</div>
					
					<script>
						let selectedLanguageCode = null;
						// Toggle the dropdown
						function toggleLanguageDropdown () {
							const dropdown = document.getElementById("dropdown-menu");
							dropdown.classList.toggle("hidden");
						}
						
						// Filter languages based on search input
						function filterLanguages () {
							const input = document.getElementById("language-search");
							const filter = input.value.toLowerCase();
							const ul = document.getElementById("language-options");
							const li = ul.getElementsByTagName("li");
							
							for (let i = 0; i < li.length; i++) {
								const txtValue = li[i].textContent || li[i].innerText;
								if (txtValue.toLowerCase().indexOf(filter) > -1) {
									li[i].style.display = "";
								} else {
									li[i].style.display = "none";
								}
							}
						}
						
						// Function to select a language and close the dropdown
						function selectLanguage (language, code) {
							const button = document.getElementById("language-button");
							button.textContent = language; // Update button text to selected language
							document.getElementById("dropdown-menu").classList.add("hidden"); // Close dropdown
							selectedLanguageCode = {
								language,
								code
							}; // Store the selected language code
						}
						
						document.addEventListener("click", function (e) {
							const dropdown = document.getElementById("dropdown-menu");
							if (!e.target.closest("#dropdown-menu") && !e.target.closest("#language-button")) {
								dropdown.classList.add("hidden"); // Close (hide) the dropdown
							}
						});
					</script>
					
					
					<script>
						function selectCategory (category) {
							const categoryButton = document.getElementById("categoryButton");
							// Change the button text to the selected category
							categoryButton.textContent = category;
							// Close the dropdown
							document.getElementById('categoryDropdown').classList.add('hidden');
						}
						
						document.getElementById('categoryButton').addEventListener('click', function () {
							const dropdown = document.getElementById('categoryDropdown');
							dropdown.classList.toggle('hidden');
							// Manage aria-expanded attribute for accessibility
							const isExpanded = dropdown.classList.contains('hidden') ? 'false' : 'true';
							this.setAttribute('aria-expanded', isExpanded);
						});
						
						// Close dropdown when clicking outside
						document.addEventListener('click', function (event) {
							const categoryButton = document.getElementById('categoryButton');
							const dropdown = document.getElementById('categoryDropdown');
							if (!categoryButton.contains(event.target) && !dropdown.contains(event.target)) {
								dropdown.classList.add('hidden');
								categoryButton.setAttribute('aria-expanded', 'false');
							}
						});
					</script>
				</form>
			</div>
			
			<div class=" mx-2 px-1 bg-white flex-grow min-w-[30rem] ">
				<div class="p-2">
					<div class="d-flex w-full justify-content-between align-items-center logo">
						<div class="title ">
							<h4 class="page-title text-xl font-bold">
								Setup Template
							</h4>
						</div>
						<!-- Submit Button -->
						<div class="text-end">
							<button type="button" class="btn btn-primary py-2 text-sm" onclick="openModal()">
								Preview
							</button>
						</div>
					</div>
					
					<div class="setup-template">
						<!-- Header -->
						<div class="d-flex align-items-end justify-content-between">
							<div class="header-text w-full">
								<h6 class="font-semibold text-lg pb-2">
									Header
									<span class="text-gray-400 font-normal">(Optional)</span>
								</h6>
							</div>
							<div class="header-dropdown form-group text-gray-400">
								<div class="select-wrapper   mt-4">
									<select id="mediaTypeDropdown" class="cursor-pointer py-2 pl-2 w-full rounded-md border border-gray-300 bg-white  text-sm focus:border-blue-200 focus:outline-none focus:ring-1 focus:ring-blue-200">
										<option class="text-sm" value="none">
											None
										</option>
										<option class="text-sm" value="text">
											Text
										</option>
										<option class="text-sm" value="media">
											Media
										</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					
					<div id="noneInputContainer" class="text-sm form-group text-gray-400 ">
						Add a title or choose which type of media
						you&apos;ll use for this header.
					</div>
					<div id="headerInputContainer" class="hidden form-group">
						<label class="text-sm text-gray-400 pb-2">Add a title.</label>
						<input type="text" class="form-control border-0" id="headerInput" placeholder="Enter header title" />
					</div>
					
					<div id="mediaInputContainer" class="hidden w-full h-10 mt-2">
						<!-- Media Type Selection -->
						<div class="select-wrapper w-48  mr-5">
							<select id="mediaType" class="w-full pl-2 cursor-pointer rounded-md border border-gray-300 bg-white py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 ">
								<option value="image">Image</option>
								<option value="video">Video</option>
								<option value="document">Document</option>
								<!-- <option value="location">Location</option> -->
							</select>
						</div>
						<!-- File Upload -->
						<label id="uploadLabel" for="file-upload" class="px-3 h-full cursor-pointer rounded-md border border-gray-300 text-gray-400 focus-within:outline-none focus-within:ring-2 focus-within:ring-blue-500 focus-within:ring-offset-2 hover:bg-gray-100 flex items-center justify-between">
							<span id="uploadText" class="h-fit w-full text-sm">Choose from .jpg or .png</span>
							<input id="file-upload" name="file-upload" type="file" class="sr-only" />
							<svg id="removeFile" xmlns="http://www.w3.org/2000/svg" class="hidden h-5 w-5 text-gray-500 cursor-pointer hover:text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
								<path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
							</svg>
						</label>
					</div>
					
					<!-- Body -->
					<div class="form-group">
						<h6 class="font-semibold text-lg pb-2 pt-1 ">
							Body
						</h6>
						<label class="  pb-2 text-gray-400 text-sm form-group" style="font-family: 'Figtree', sans-serif;">Enter the text for your message in the language
							that you&apos;ve selected. Add {{1}}, {{2}}, {{3}}
							(Curly Braceses and numbers) to add Dynamic
							values</label>
						<div class="border rounded shadow-sm relative z-0">
							<div class="px-2 h-fit d-flex align-items-center justify-content-between" role="toolbar">
								<div id="toolbar" class="relative flex text-gray-400">
									<button class="py-1 px-2 rounded-lg" onclick="formatText('bold', this)">
										<i class="fa fa-bold text-sm"></i>
									</button>
									<button class="py-1 px-2 rounded-lg" onclick="formatText('italic', this)">
										<i class="fa fa-italic text-sm"></i>
									</button>
									<button class="py-1 px-2 rounded-lg" onclick="formatText('underline', this)">
										<i class="fa fa-underline text-sm"></i>
									</button>
									<button class="py-1 px-2 rounded-lg" onclick="formatText('strikethrough', this)">
										<i class="fa fa-strikethrough text-sm"></i>
									</button>
									<button class="text-sm py-1 px-2 rounded-lg" onclick="addBrackets()">
									
										{{}}
									</button>
									
									<!-- Emoji button -->
									<button id="emojiBtn" onclick="openEmojis()" class="rounded text-sm py-1 px-2 ">
										😊
									</button>
								</div>
								<div id="emojiContainer" class="hidden absolute top-full left-0 bg-white p-4 rounded shadow-lg w-[480px] h-52 overflow-y-auto z-50">
									<input id="emojiSearch" type="text" placeholder="Search for emojis..." class=" border shadow-md focus:shadow-lg rounded p-2 mb-3 w-full" />
									<div id="emojiList" class="grid grid-cols-6 gap-2"></div>
								</div>
								
								<div class="count mt-[-6px]">
									<small class="text-gray-400 text-sm" id="charCount">0/1024</small>
								</div>
							</div>
							<!-- <textarea id="bodyInput" class="w-full h-full px-2 text-sm" placeholder="Enter body here" contenteditable="true" maxlength="1024" cols="1"></textarea> -->
							
							<div id="bodyInput" class="focus:outline-none p-2 text-sm" contenteditable="true" maxlength="1024" style="min-height: 50px; height: auto"></div>
						</div>
						
						
						<!-- Footer -->
						<div class="form-group mt-3">
							<h6 class="font-semibold text-lg pb-2">Footer</h6>
							<label class=" text-gray-400 pb-2 text-sm">Add a short line of text to bottom of your
								message template, if you add the marketing
								opt-out button, the associated footer will be
								shown here by default.</label>
							<div class="border rounded shadow-sm d-flex align-items-center justify-content-between p-2">
								<textarea class="border-0 w-full text-sm bg-transparent focus:outline-none outline-none focus-within:outline-none" maxlength="60" rows="1" id="footerInput" placeholder="Enter footer text"></textarea>
								<div class="count">
									<small class="text-gray-400 footer-count float-end">0/60</small>
								</div>
							</div>
						</div>
						
						<!-- Buttons -->
						<div class="form-group mt-2 mb-32">
							<h6 class="font-semibold text-lg pb-2">
								Buttons
								<span class="text-secondary small text-sm">(optional)</span>
							</h6>
							<label class="font-medium text-secondary pb-2 text-sm">Create buttons that let customers respond to
								your message or take action.
							</label>
							<!-- Button Dropdown -->
							<div class="w-fit mt-4">
								<div class="relative w-full">
									<!-- Button to toggle dropdown -->
									<button id="addButtonDropdown" class="text-sm w-fit h-fit bg-transparent border border-gray-300 rounded px-4 py-2 cursor-pointer text-left text-black focus:outline-none" type="button">
										+ Add a button
									</button>
									
									<!-- Dropdown with options -->
									<div id="buttonDropdown" class="hidden absolute bg-white border border-gray-200 rounded mt-2 py-2 shadow-lg w-full z-50">
										<div class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer" id="addWebsiteBtn">Visit Website</div>
										<div class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer" id="addCallBtn">Call Phone Number</div>
									</div>
								</div>
							</div>
							<div id="buttonOptions" class="space-y-3">
								<!-- Hidden Website Button Form -->
								<div id="websiteForm" class="border rounded shadow-sm action-card mt-3 draggable" style="display: none;" draggable="true">
									<div class="d-flex justify-evenly items-center">
										<div class="drag-handle">::</div>
										<div class="row w-100">
											<div class="col-4">
												<label>Button label</label>
												<input type="text" class="form-control" id="websiteBtnLabel" placeholder="Visit Now">
											</div>
											<div class="col-4">
												<label>Website URL</label>
												<input type="url" class="form-control" id="websiteUrl" placeholder="example.com">
											</div>
										</div>
										<div class="col-1 close-icon">
											<span class="remove-btn" id="closeWebsite">&times;</span>
										</div>
									</div>
								</div>
								
								<!-- Hidden Call Button Form -->
								<div id="callForm" class="border rounded shadow-sm action-card mt-3 draggable" style="display: none;" draggable="true">
									<div class="d-flex justify-evenly items-center">
										<div class="drag-handle">::</div>
										<div class="row w-100">
											<div class="col-4">
												<label>Button label</label>
												<input type="text" class="form-control" id="callBtnLabel" placeholder="Call Now">
											</div>
											<div class="col-4">
												<label>Phone Number</label>
												<input type="tel" class="form-control" id="phoneNumber" minlength="12" maxlength="15" placeholder="9999999999">
											</div>
										</div>
										<div class="col-1 close-icon">
											<span class="remove-btn" id="closeCall">&times;</span>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="px-1 bg-white min-w-[25rem] max-w-[25rem]">
				<div class="p-3">
					<div class="title logo w-full">
						<h4 class="page-title text-xl font-bold text-center">
							Template Preview
						</h4>
					</div>
					<!-- Preview Section -->
					<div class="py-3 px-2 mt-3" id="previewContainer">
						<div id="previewHeader" class="text-lg font-semibold"></div>
						<p id="previewBody" class="text-base"></p>
						<div id="previewFooter"></div>
						<div class="py-2" id="previewButtons"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<%- include("partials/template-preview-modal") %>
	<script>
		const mediaFileData = <%- JSON.stringify(mediaFileData) %>;
		const mediaFileName = <%- JSON.stringify(mediaFileName) %>;
		// console.log(JSON.stringify(data));
	</script>
	<script src="/toast.js"></script>
	<script src="/menu.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
	<script src=" assets/plugins/pace/pace.min.js" type="text/javascript"></script>
	<script src="assets/plugins/liga.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery/jquery-3.2.1.min.js" type="text/javascript"></script>
	<script src="assets/plugins/modernizr.custom.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>
	<script src="assets/plugins/popper/umd/popper.min.js" type="text/javascript"></script>
	<script src="assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery/jquery-easy.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery-unveil/jquery.unveil.min.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery-ios-list/jquery.ioslist.min.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery-actual/jquery.actual.min.js"></script>
	<script src="assets/plugins/jquery-scrollbar/jquery.scrollbar.min.js"></script>
	<script type="text/javascript" src="assets/plugins/select2/js/select2.full.min.js"></script>
	<script type="text/javascript" src="assets/plugins/classie/classie.js"></script>
	<script src="pages/js/pages.js" type="text/javascript"></script>
	<script src="assets/js/scripts.js" type="text/javascript"></script>
	
	<script src="template/js/submit-template.js"></script>
	<script src="template/js/fetchEmoji.js"></script>
	
	<script src="template/js/fetch-preview.js"></script>
	<script src="template/js/create-template.js"></script>
	<!-- <script src="template/js/fetch-preview.js"></script> -->
	
</body>

</html>