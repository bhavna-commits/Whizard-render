<div class="p-4 w-full ">
	<!-- Responsive Table -->
	<div class="overflow-x-auto">
		<table class="text-center min-w-full border-separate border-spacing-y-4">
			<tbody class="">
				<tr class=" text-gray-500 tracking-wider">
					<td class="">Sno.</td>
					<td class="w-fit">Template Name</td>
					<td class="">Category</td>
					<td class="">Language</td>
					<td class="">Status</td>
					<td class="">Actions</td>
				</tr>
				
				<% list.forEach((list, i) => { %>
				<tr class="hover:bg-gray-100">
					<td class="border-l border-t border-b rounded-lg py-4 border-gray-200 text-sm text-gray-500"><%= ++i %></td>
					<td class="border-t border-b border-gray-200  w-48 text-left ">
						<a href="#" class="text-blue-600 hover:underline ">
							<div class="pl-4">
								<p class="text-gray-700 font-semibold"><%= list.name %></p>
								<p class="text-gray-500 text-sm" id="createdAt-<%= list._id %>" data-timestamp="<%= list.updatedAt %>"></p>
							</div>
						</a>
					</td>
					<td class=" text-gray-500 border-t border-b border-gray-200"><%= list.category %></td>
					<td class="border-t border-b border-gray-200">
						<span class="inline-block px-2 py-1 text-gray-500 rounded-full"><%= list.language.language %></span>
					</td>
					<td class="border-t border-b border-gray-200">
						<% if (list.status === 'Rejected') { %>
						<span class="text-orange-500  font-semibold" title="Rejected Reason: <%= list.rejected_reason %>">
							<%= list.status %>
						</span>
						<% } else if (list.status === 'Pending') { %>
						<span class="text-orange-500  font-semibold">
							<%= list.status %>
						</span>
						<% } else { %>
						<span class="text-green-500  font-semibold">
							<%= list.status %>
						</span>
						<% } %>
					</td>
					
					<td class="border-r border-t border-b rounded-lg border-gray-200">
						<% if (access?.templates?.duplicateTemplate) { %>
						<!-- Duplicate Button -->
						<button type="button" class="text-gray-500 hover:text-gray-700 px-3 border-r" onclick="duplicateTemplate('<%= list._id %>')">
							<i class="fa-regular fa-copy"></i>
						</button>
						<% } else { %>
						<!-- Duplicate Button -->
						<button type="button" class="text-gray-500 hover:cursor-not-allowed px-3 border-r" title="You don't have permissions to access this" disabled>
							<i class="fa-regular fa-copy"></i>
						</button>
						<% } %>
						<% if (access?.templates?.deleteTemplate) { %>
						<!-- Delete Button -->
						<button type="button" class="text-gray-500 hover:text-red-700 px-2" onclick="confirmDelete('<%= list._id %>')">
							<i class="fa-regular fa-trash-can"></i>
						</button>
						<% } else { %>
						<!-- Delete Button -->
						<button type="button" class="text-gray-500 hover:cursor-not-allowed px-2" title="You don't have permissions to access this" disabled>
							<i class="fa-regular fa-trash-can"></i>
						</button>
						<% } %>
					</td>
				</tr>
				<% }) %>
				
			</tbody>
		</table>
	</div>
	
	
	<script>
		// Helper function to format date in "29 Aug-2024 at 02:05 AM" format
		function formatTimestamp (timestamp) {
			const date = new Date(timestamp);
			const options = {
				day: '2-digit',
				month: 'short',
				year: 'numeric',
				hour: '2-digit',
				minute: '2-digit',
				hour12: true
			};
			
			// Format the date and time string
			let formattedDate = date.toLocaleString('en-GB', options);
			formattedDate = formattedDate.replace(',', ' at ');
			return formattedDate;
		}
		
		// Format all timestamps with the 'data-timestamp' attribute
		document.querySelectorAll('[data-timestamp]').forEach((element) => {
			const timestamp = element.getAttribute('data-timestamp');
			element.textContent = formatTimestamp(timestamp);
		});
		
		function duplicateTemplate (templateId) {
			location.href = `/api/templates/duplicate/${templateId}`;
		}
		
		// Function to confirm deletion
		function confirmDelete (templateId) {
			if (confirm('Are you sure you want to delete this template?')) {
				fetch(`/api/templates/delete/${templateId}`, {
						method: 'DELETE',
						headers: {
							'Content-Type': 'application/json',
						},
					})
					.then((response) => response.json())
					.then((data) => {
						if (data.success) {
							window.location.reload();
						} else {
							alert('Error deleting template: ' + data.error);
						}
					})
					.catch((error) => console.error('Error:', error));
			}
		}
	</script>