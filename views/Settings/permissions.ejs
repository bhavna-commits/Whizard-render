<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
	<meta charset="utf-8" />
	<title>User Management - </title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no" />
	<link rel="apple-touch-icon" href="pages/ico/60.png" />
	<link rel="apple-touch-icon" sizes="76x76" href="pages/ico/76.png" />
	<link rel="apple-touch-icon" sizes="120x120" href="pages/ico/120.png" />
	<link rel="apple-touch-icon" sizes="152x152" href="pages/ico/152.png" />
	<link rel="icon" type="image/x-icon" href="favicon.ico" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-touch-fullscreen" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="default" />
	<meta content="Meet pages - The simplest and fastest way to build web UI for your dashboard or app." name="description" />
	<meta content="Ace" name="author" />
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	<link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
	<!-- <script src="https://viralpitch.co/insights/app/js/apexcharts-bundle/dist/apexcharts.js"></script>
	<link rel="stylesheet" href="styles/template.css" />
	<link rel="stylesheet" href="https://viralpitch.co/insights/app/js/apexcharts-bundle/dist/apexcharts.css" /> -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
	<link href="styles/style.css" rel="stylesheet" type="text/css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" type="text/css" href="styles/permissions.css" />
</head>

<body>
	<!-- Loader HTML -->
	<div id="loader" class="loader">
		<div class="w-full h-full flex justify-center items-center">
			<img src="/assets/img/Wizard_logo.png" alt="Whizard Logo" class="animate-pulse loading-image" />
		</div>
	</div>
	
	<div class="layout-container">
		<nav class="sidebar">
			<div class="logo">
				<img onclick="location.href = '/'" class="cursor-pointer" src="/assets/img/Wizard_logo.png" alt="Whizard Logo" />
			</div>
			<ul class="">
				<!-- Dashboard: Always enabled -->
				<li>
					<a href="/" class="">
						<span class="icon"><i class="fas fa-chart-line"></i></span>
						Dashboard
					</a>
				</li>
				
				<!-- Chats: Conditionally rendered based on permissions -->
				<li>
					<% if (access?.chats?.type) { %>
					<a href="/chats" class="">
						<span class="icon"><i class="fa-regular fa-comment"></i></span>
						Chats
					</a>
					<% } else { %>
					<a href="javascript:void(0);" title="You don't have permissions to access this" class="cursor-not-allowed">
						<span class="icon"><i class="fa-regular fa-comment"></i></span>
						Chats
					</a>
					<% } %>
				</li>
				
				<!-- Contact List: Conditionally rendered based on permissions -->
				<li>
					<% if (access?.contactList?.type) { %>
					<a href="/contact-list">
						<span class="icon "><i class="fa-regular fa-address-book"></i></span>
						Contact List
					</a>
					<% } else { %>
					<a href="javascript:void(0);" title="You don't have permissions to access this" class="cursor-not-allowed">
						<span class="icon"><i class="fa-regular fa-address-book"></i></span>
						Contact List
					</a>
					<% } %>
				</li>
				
				<!-- Template: Conditionally rendered based on permissions -->
				<li>
					<% if (access?.templates?.type) { %>
					<a href="/template">
						<span class="icon"><i class="fa-regular fa-envelope"></i></span>
						Template
					</a>
					<% } else { %>
					<a href="javascript:void(0);" title="You don't have permissions to access this" class="cursor-not-allowed">
						<span class="icon"><i class="fa-regular fa-envelope"></i></span>
						Template
					</a>
					<% } %>
				</li>
				
				<!-- Settings: Conditionally rendered based on permissions -->
				<li>
					<% if (access?.settings?.type) { %>
					<a href="/settings">
						<span class="icon active"><i class="fa-regular fa-user"></i></span>
						Settings
					</a>
					<% } else { %>
					<a href="javascript:void(0);" title="You don't have permissions to access this" class="cursor-not-allowed">
						<span class="icon"><i class="fa-regular fa-user"></i></span>
						Settings
					</a>
					<% } %>
				</li>
				
				<!-- Reports: Conditionally rendered based on permissions -->
				<li>
					<% if (access?.reports?.type) { %>
					<a href="/reports/campaign-list">
						<span class="icon"><i class="fa-regular fa-chart-bar"></i></span>
						Reports
					</a>
					<% } else { %>
					<a href="javascript:void(0);" title="You don't have permissions to access this" class="cursor-not-allowed">
						<span class="icon"><i class="fa-regular fa-chart-bar"></i></span>
						Reports
					</a>
					<% } %>
				</li>
			</ul>
			<div class=" user-profile text-white flex justify-center items-center text-center">
				<% if (photo) { %>
				<img src="/<%= photo %>" alt="User Profile" class="user-profile-img" onclick="toggleDropdown()" />
				<% } else { %>
				<!-- Extract and display the initials -->
				<div class="user-profile-name bg-[<%= color %>]" onclick="toggleDropdown()">
					<% let initials = name.split(' ').map(n => n[0].toUpperCase()).join(''); %>
					<%= initials %>
				</div>
				<% } %>
				<div id="dropdownMenu" class="account-menu hidden">
					<a href="/settings/profile">Profile</a>
					<button onclick="logout()">Logout</button>
				</div>
			</div>
			
			<script>
				function toggleDropdown () {
					const dropdownMenu = document.getElementById('dropdownMenu');
					dropdownMenu.classList.toggle('hidden');
					
					const sidebar = document.querySelector('.sidebar');
					
					if (dropdownMenu.classList.contains('hidden')) {
						sidebar.style.overflow = 'auto';
					} else {
						sidebar.style.overflow = 'visible';
					}
				}
				
				async function logout () {
					try {
						const response = await fetch('/api/users/logout', {
							method: 'POST',
							credentials: 'same-origin'
						});
						
						if (response.ok) {
							window.location.href = '/login';
						} else {
							alert('Error logging out.');
						}
					} catch (err) {
						console.error('Error:', err);
						alert('Error logging out.');
					}
				}
				
				// Close the dropdown if clicked outside
				window.onclick = function (event) {
					const dropdown = document.getElementById("dropdownMenu");
					const sidebar = document.querySelector('.sidebar');
					if (!event.target.closest('.user-profile')) {
						dropdown.classList.add("hidden");
						sidebar.style.overflow = 'auto';
					}
				};
			</script>
		</nav>
		<!-- END SIDEBAR MENU TOP TRAY CONTENT-->
		
		<!-- START PAGE-CONTAINER -->
		<div class="main-content">
			<div class="logo breadCrumb">
				<nav class="flex " aria-label="Breadcrumb">
					<div class="flex items-center">
						<a href="/settings" class="text-gray-500 hover:text-gray-700 text-xl font-medium">Settings</a>
						<svg class="w-4 h-4 mx-2 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L11.586 10 7.293 5.707a1 1 0 011.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
						</svg>
					</div>
					
					<div class="flex items-center">
						<a href="/settings/user-management" class="text-gray-500 hover:text-gray-700 text-xl font-medium ">User Management</a>
						<svg class="w-4 h-4 mx-2 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L11.586 10 7.293 5.707a1 1 0 011.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
						</svg>
					</div>
					<div class="flex items-center">
						<a href="/settings/user-management/permissions" class="text-red-500 hover:text-gray-700 text-xl font-medium ">Permissions</a>
					</div>
				</nav>
			</div>
			<div class="mainDiv">
				
				<div class="container mx-auto px-4 py-8">
					<div class="">
						<div class="flex justify-between items-center mb-6">
							<h1 class="text-xl font-medium">Role Management</h1>
							<div id="statusMessage" class="hidden"></div>
						</div>
						
						<form id="roleForm" class="space-y-6 border rounded-xl p-6">
							<!-- Role Name Section -->
							<div class="space-x-2 flex items-center justify-between ">
								<label for="roleName" class="block text-lg font-medium pt-2">Role Name</label>
								<input type="text" id="roleName" placeholder="Enter role name" name="roleName" required class="w-[60%] p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
							</div>
							
							<!-- Dashboard Section -->
							<div class="border-t pt-4 flex items-center justify-between ">
								<h2 class="text-lg font-medium mb-4">Dashboard</h2>
								<div class="grid grid-cols-1 md:grid-cols-5   w-[60%]">
									<label class="flex items-center space-x-2 min-w-fit">
										<input type="checkbox" name="conntectNow" value="connectNow" class="rounded checkbox text-blue-600">
										<span>Connect Now</span>
									</label>
									<label class="flex items-center space-x-2 min-w-fit">
										<input type="checkbox" name="viewUsers" value="viewUsers" class="rounded checkbox text-blue-600">
										<span>View Users</span>
									</label>
									<label class="flex items-center space-x-2 min-w-fit">
										<input type="checkbox" name="quickActions" value="quickActions" class="rounded checkbox text-blue-600">
										<span>Quick Actions</span>
									</label>
								</div>
							</div>
							
							<!-- Chats Section -->
							<div class="border-t pt-4 flex justify-between items-center toggle-section">
								<div class="flex justify-between items-center w-[15%] relative">
									<h2 class="text-lg font-semibold">Chats</h2>
									<div class="flex items-center space-x-2">
										<label class="relative flex pt-2 items-center cursor-pointer ">
											<!-- Hidden checkbox input -->
											<input type="checkbox" name="permissions[chats]" class="sr-only peer section-toggle">
											
											<!-- Toggle switch -->
											<div class="w-11 h-6  bg-gray-200 peer-focus:outline-none peer-focus:ring-4 
												peer-focus:ring-blue-300 rounded-full peer 
												peer-checked:after:translate-x-full peer-checked:after:border-white 
												after:content-[''] after:absolute after:top-[.65rem] after:left-[.12rem] 
												after:bg-white after:border-gray-300 after:border after:rounded-full 
												after:h-5 after:w-5 after:transition-all peer-checked:bg-black"></div>
											
											<!-- Label text -->
											<span class="ml-3 text-sm font-medium toggle-label text-gray-500">No</span>
										</label>
										
									</div>
								</div>
								<div class="options-container grid grid-cols-1 md:grid-cols-5 w-[60%]">
									<label class="flex items-center space-x-2 min-w-fit">
										<input type="checkbox" name="permissions[dashboard][]" value="connectNow" class="rounded checkbox option-checkbox text-black" disabled />
										<span class="option-label text-gray-500">Redirected to VP chat</span>
									</label>
								</div>
							</div>
							
							<!-- Contact List Section -->
							<div class="border-t pt-4 flex justify-between toggle-section">
								<div class="flex justify-between items-center w-[15%] mb-4">
									<h2 class="text-lg font-semibold">Contact List</h2>
									<div class="flex items-center space-x-2">
										<label class="relative inline-flex pt-2 items-center cursor-pointer">
											<input type="checkbox" name="permissions[contactList]" class="sr-only peer section-toggle">
											<div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 
												peer-focus:ring-blue-300 rounded-full peer 
												peer-checked:after:translate-x-full peer-checked:after:border-white 
												after:content-[''] after:absolute after:top-[.65rem] after:left-[.12rem]
												after:bg-white after:border-gray-300 after:border after:rounded-full 
												after:h-5 after:w-5 after:transition-all peer-checked:bg-black">
											</div>
											<span class="ml-3 text-sm font-medium toggle-label text-gray-500">No</span>
										</label>
									</div>
								</div>
								<div class="options-container grid grid-cols-1 md:grid-cols-5 w-[60%]">
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[contactList][]" value="addContactIndividual" class="rounded option-checkbox text-blue-600 checkbox" />
										<span class="option-label text-gray-500">Add Contact</span>
									</label>
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[contactList][]" value="editContactIndividual" class="rounded option-checkbox text-blue-600 checkbox" />
										<span class="option-label text-gray-500">Edit Contact</span>
									</label>
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[contactList][]" value="deleteContactIndividual" class="rounded option-checkbox text-blue-600 checkbox" />
										<span class="option-label text-gray-500">Delete Contact</span>
									</label>
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[contactList][]" value="addContactListCSV" class="rounded option-checkbox text-blue-600 checkbox" />
										<span class="option-label text-gray-500">Upload Contact List</span>
									</label>
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[contactList][]" value="deleteList" class="rounded option-checkbox text-blue-600 checkbox" />
										<span class="option-label text-gray-500">Delete List</span>
									</label>
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[contactList][]" value="sendBroadcast" class="rounded option-checkbox text-blue-600 checkbox" />
										<span class="option-label text-gray-500">Send Broadcast</span>
									</label>
								</div>
							</div>
							
							<!-- Templates Section -->
							<div class="border-t pt-4 flex justify-between toggle-section">
								<div class="flex justify-between items-center  w-[15%] mb-4">
									<h2 class="text-lg font-semibold">Templates</h2>
									<div class="flex items-center space-x-2">
										<label class="relative inline-flex  pt-2 items-center cursor-pointer">
											<input type="checkbox" name="permissions[templates][enabled]" class="sr-only peer section-toggle">
											<div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 
                                          peer-focus:ring-blue-300 rounded-full peer 
                                          peer-checked:after:translate-x-full peer-checked:after:border-white 
                                          after:content-[''] after:absolute after:top-[.65rem] after:left-[.12rem]
                                          after:bg-white after:border-gray-300 after:border after:rounded-full 
                                          after:h-5 after:w-5 after:transition-all peer-checked:bg-black"></div>
											<span class="ml-3 text-sm font-medium toggle-label text-gray-500">No</span>
										</label>
									</div>
								</div>
								<div class="options-container grid grid-cols-1 md:grid-cols-5 w-[60%]">
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[templates][]" value="editTemplate" class="rounded checkbox option-checkbox  text-blue-600">
										<span class="option-label text-gray-500">Edit Template</span>
									</label>
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[templates][]" value="createTemplate" class="rounded checkbox option-checkbox  text-blue-600">
										<span class="option-label text-gray-500">Create Template</span>
									</label>
									<label class="flex items-center space-x-2">
										<input type="checkbox" name="permissions[templates][]" value="deleteTemplate" class="rounded checkbox option-checkbox  text-blue-600">
										<span class="option-label text-gray-500">Delete Template</span>
									</label>
								</div>
							</div>
							
							<!-- Reports Section -->
							<div class="border-t pt-4 flex justify-between toggle-section">
								<div class="flex justify-between items-center w-[15%] mb-4">
									<h2 class="text-lg font-semibold">Reports</h2>
									<div class="flex items-center space-x-2">
										<label class="relative inline-flex pt-2 items-center cursor-pointer">
											<input type="checkbox" name="permissions[reports][enabled]" class="sr-only peer section-toggle">
											<div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 
                  peer-focus:ring-blue-300 rounded-full peer 
                  peer-checked:after:translate-x-full peer-checked:after:border-white 
                  after:content-[''] after:absolute after:top-[.625rem] after:left-[.12rem]
                  after:bg-white after:border-gray-300 after:border after:rounded-full 
                  after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
											<span class="ml-3 text-sm font-medium toggle-label text-gray-500">No</span>
										</label>
									</div>
								</div>
								
								<div class="options-container grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 w-[60%]">
									<div>
										<label class="flex items-center space-x-2">
											<input type="checkbox" name="permissions[reports][]" value="conversationReports" class="rounded option-checkbox  checkbox text-blue-600 toggle-option conversation-toggle">
											<span class="option-label text-gray-500">Conversation Reports</span>
										</label>
										
										<div class="grid-flow-col gap-4 pl-3 nested-options">
											<label class="flex items-center space-x-2">
												<input type="checkbox" name="permissions[reports][]" value="viewReports" class="rounded nested-checkbox  checkboxSmall text-blue-600 text-sm toggle-option">
												<span class="text-sm nested-label text-gray-500">View Reports</span>
											</label>
											<label class="flex text-sm items-center space-x-2">
												<input type="checkbox" name="permissions[reports][]" value="retargetingUsers" class="rounded nested-checkbox  checkboxSmall text-blue-600 text-sm toggle-option">
												<span class="text-sm nested-label text-gray-500">Retargeting Users</span>
											</label>
											<label class="flex text-sm items-center space-x-2">
												<input type="checkbox" name="permissions[reports][]" value="redirectedToVPChat" class="rounded nested-checkbox checkboxSmall text-blue-600 text-sm toggle-option">
												<span class="text-sm nested-label text-gray-500">Redirected to VP chat</span>
											</label>
										</div>
									</div>
									
									<label class="flex space-x-2">
										<input type="checkbox" name="permissions[reports][]" value="costReports" class="rounded option-checkbox checkbox text-blue-600 toggle-option">
										<span class="option-label text-gray-500">Cost Reports</span>
									</label>
								</div>
							</div>
							
							<!-- Settings Section -->
							<div class="border-t pt-4 flex justify-between toggle-section">
								<div class="flex justify-between items-center mb-4 w-[15%]">
									<h2 class="text-lg font-semibold">Settings</h2>
									<div class="flex items-center space-x-2">
										<label class="relative inline-flex items-center cursor-pointer">
											<input type="checkbox" name="permissions[settings][enabled]" class="sr-only peer section-toggle" id="settings-toggle">
											<div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 
                peer-focus:ring-blue-300 rounded-full peer 
                peer-checked:after:translate-x-full peer-checked:after:border-white 
                after:content-[''] after:absolute after:top-[2px] after:left-[2px] 
                after:bg-white after:border-gray-300 after:border after:rounded-full 
                after:h-5 after:w-5 after:transition-all peer-checked:bg-black"></div>
											<span class="ml-3 text-sm font-medium toggle-label text-gray-500">No</span>
										</label>
									</div>
								</div>
								
								<div class="options-container grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 w-[60%]">
									<div class="permission-group" id="manage-tags-section">
										<label class="flex items-center space-x-2">
											<input type="checkbox" name="permissions[settings][]" value="manageTags" class="rounded option-checkbox checkbox text-blue-600 toggle-option" id="manage-tags-toggle">
											<span class="option-label text-gray-500">Manage Tags</span>
										</label>
										<div class="grid-flow-col gap-4 pl-3 nested-options" id="manage-tags-options">
											<label class="flex items-center space-x-2">
												<input type="checkbox" name="permissions[settings][]" value="addTags" class="rounded checkboxSmall text-blue-600 text-sm nested-checkbox" id="add-tags">
												<span class="text-sm nested-label text-gray-500">Add Tags</span>
											</label>
											<label class="flex items-center space-x-2">
												<input type="checkbox" name="permissions[settings][]" value="deleteTags" class="rounded checkboxSmall text-blue-600 text-sm nested-checkbox" id="delete-tags">
												<span class="text-sm nested-label text-gray-500">Delete Tags</span>
											</label>
											<label class="flex items-center space-x-2">
												<input type="checkbox" name="permissions[settings][]" value="viewTags" class="rounded checkboxSmall text-blue-600 text-sm nested-checkbox" id="view-tags">
												<span class="text-sm nested-label text-gray-500">View Tags</span>
											</label>
										</div>
									</div>
									
									<label class="flex space-x-2">
										<input type="checkbox" name="permissions[settings][]" value="userManagement" class="rounded option-checkbox checkbox text-blue-600" id="user-management">
										<span class="option-label text-gray-500">User Management</span>
									</label>
									<label class="flex space-x-2">
										<input type="checkbox" name="permissions[settings][]" value="activityLogs" class="rounded option-checkbox checkbox text-blue-600" id="activity-logs">
										<span class="option-label text-gray-500">Activity Logs</span>
									</label>
								</div>
							</div>
							
							<!-- Form Action Buttons -->
							<div class="flex justify-end space-x-4 pt-6 border-t">
								<button type="button" onclick="location.href = '/settings/user-management'" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
									Cancel
								</button>
								<button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-gray-700 border border-transparent rounded-md hover:bg-black focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
									Add Role
								</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="/settings/js/permissions.js"></script>
	<script>
		window.addEventListener('load', function () {
			// Fade out the loader smoothly by changing the opacity
			var loader = document.getElementById('loader');
			loader.style.transition = 'opacity 0.3s ease'; // Smooth fade out
			loader.style.opacity = '0';
			
			// Completely remove the loader after the fade-out effect is finished
			setTimeout(function () {
				loader.style.display = 'none'; // Ensure loader is no longer in the DOM flow
			}, 300); // Match the duration of the fade-out (0.5 seconds in this case)
		});
	</script>
</body>

</html>