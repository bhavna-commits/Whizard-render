<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<title>Dashboard</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0 shrink-to-fit=no" />
	<link rel="icon" type="image/x-icon" href="favicon.ico" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
	<link href="assets/plugins/pace/pace-theme-flash.css" rel="stylesheet" type="text/css" />
	<link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
	<link href="assets/plugins/jquery-scrollbar/jquery.scrollbar.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="assets/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" media="screen" />
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	<link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
	<script src="https://cdn.tailwindcss.com"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>
	<link rel="stylesheet" href="styles/filter-sidebar.css" />
	<link rel="stylesheet" href="styles/style.css" />
	<link rel="stylesheet" href="styles/dashboard.css" />
	<link rel="stylesheet" href="/styles/countrySelector.css" />
</head>

<%- include("../commonJS/loader") %>

<body class="bg-white">
	
	<!-- Sidebar -->
	<div class="layout-container">
		
		<%- include("../commonJS/sidebar")  %>
		
		<!-- Main Content -->
		<div class="p-4 w-full overflow-y-scroll relative">
			<div class="flex justify-between items-center">
				<div class="flex items-center">
					<h1 class="text-2xl font-semibold">Dashboard</h1>
					<div class="relative inline-block pl-2">
						<i class="info-icon text-gray-700 hover:text-gray-900">
							<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<circle cx="12" cy="12" r="10"></circle>
								<line x1="12" y1="16" x2="12" y2="12"></line>
								<line x1="12" y1="8" x2="12.01" y2="8"></line>
							</svg>
							
						</i>
						<div class="tooltip invisible opacity-0 w-64 bg-gray-900 text-white text-sm rounded-lg absolute z-100 p-4 -translate-x-1/2 left-1/2 mt-2 transition-opacity duration-300">
							<!-- Arrow -->
							<div class="absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-gray-900 transform rotate-45"></div>
							<!-- Content -->
							<div class="relative">
								View key analytics like sent, delivered, replied, and failed messages. Quick actions help navigate to reports, contacts, and broadcasts.
							</div>
						</div>
					</div>
				</div>
				<!-- <div id="screenSizeDisplay">Screen Width: 0px, Screen Height: 0px</div> -->
				<span class="p-text text-lg">WhatsApp API status:
					<span class="<%= status === 'Pending' ? 'text-red-500' : 'text-green-500' %> text-lg">
						<%= status %>
					</span>
				</span>
			</div>
			<p class="p-text py-2">
				All the statistics from your account are displayed here. You
				can apply various filters to refine the data and get fully
				customized results.
			</p>
			
			<div id="afterSignUpLoader" class="fixed inset-0 flex justify-center items-center bg-gray-500 bg-opacity-50 hidden">
				<div class="loader border-t-4 border-blue-500 rounded-full w-12 h-12 animate-spin"></div>
			</div>
			
			<% if (status === "Pending") { %>
			<div class="gradient-bg mb-5 rounded-2xl shadow-slate-700 shadow-md overflow-hidden relative h-44">
				<div class="p-8 flex flex-col justify-center h-full relative z-10">
					<h1 class="text-3xl font-semibold text-white mb-2">
						Connect your WhatsApp Business Number
					</h1>
					<p class="text-gray-400 text-sm mb-4">
						Start engaging with your customers through WhatsApp
						Business API
					</p>
					<% if ( access?.dashboard?.connectNow ) { %>
					<button id="connectBtn" onclick="launchWhatsAppSignup()" class="connect-btn bg-white text-gray-900 px-4 py-2 rounded-full text-sm font-medium inline-flex items-center w-fit hover:bg-gray-50">
						Connect Now
					</button>
					<% } else { %>
					<button title="You don't have permissions to access this" class="connect-btn bg-white text-gray-500 hover:cursor-not-allowed px-4 py-2 rounded-full text-sm font-medium inline-flex items-center w-fit hover:bg-gray-50">
						Connect Now
					</button>
					<% } %>
				</div>
				
				<!-- Phone Icon -->
				<div class="phone-circles">
					<!-- Outer Circle -->
					<div class="relative w-[500px] h-[500px]">
						<div class="absolute inset-0 rounded-full circle-gradient"></div>
						<!-- Middle Circle -->
						<div class="absolute inset-8 rounded-full circle-gradient"></div>
						<!-- Inner Circle with Phone Icon -->
						<div class="absolute inset-16 rounded-full circle-gradient flex items-center justify-center">
							
							<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="white" class="bi bi-telephone border-white" viewBox="0 0 16 16">
								<path d="M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.6 17.6 0 0 0 4.168 6.608 17.6 17.6 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.68.68 0 0 0-.58-.122l-2.19.547a1.75 1.75 0 0 1-1.657-.459L5.482 8.062a1.75 1.75 0 0 1-.46-1.657l.548-2.19a.68.68 0 0 0-.122-.58zM1.884.511a1.745 1.745 0 0 1 2.612.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.68.68 0 0 0 .178.643l2.457 2.457a.68.68 0 0 0 .644.178l2.189-.547a1.75 1.75 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.6 18.6 0 0 1-7.01-4.42 18.6 18.6 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877z" />
							</svg>
						</div>
					</div>
				</div>
				<div class="absolute inset-0 bg-gradient-to-r from-transparent to-black/20"></div>
				
				<!-- Status Message -->
				<div id="statusMessage" class="mt-4 p-4 rounded-lg hidden">
					<!-- Will be populated by JavaScript -->
				</div>
			</div>
			<% } %>
			<!-- Filter Bar -->
			<div class="flex items-center justify-between my-3">
				<div class="flex space-x-5">
					<div class="border w-fit flex p-2 rounded-md hover:cursor-pointer" id="filterDate">
						<svg xmlns="http://www.w3.org/2000/svg" height="1.5rem" viewBox="0 -960 960 960" width="1.5rem" fill="#000000">
							<path d="M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Zm280 240q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm-160 0q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm320 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM480-240q-17 0-28.5-11.5T440-280q0-17 11.5-28.5T480-320q17 0 28.5 11.5T520-280q0 17-11.5 28.5T480-240Zm-160 0q-17 0-28.5-11.5T280-280q0-17 11.5-28.5T320-320q17 0 28.5 11.5T360-280q0 17-11.5 28.5T320-240Zm320 0q-17 0-28.5-11.5T600-280q0-17 11.5-28.5T640-320q17 0 28.5 11.5T680-280q0 17-11.5 28.5T640-240Z" />
						</svg><span id="showDateFilter" class="pl-2">Choose the interval</span>
					</div>
					<div class="border w-fit flex p-2 rounded-md hover:cursor-pointer items-center">
						<div class="watchDemo flex items-center"><img src="svg/demo.svg" alt="Demo" class="pr-2 "> Watch Demo
						</div>
					</div>
					<% if (user?.payment?.plan !== "unlimited" || user?.payment?.plan !== "noplan") { %>
					<button class="gradient-button rounded-md p-2 flex items-center" onclick="location.href='/settings/payments'">
						<img src="svg/coins.svg" alt="" class="w-6 mr-2">
						Payment Plan
					</button>
					<% } %>
					<% if (admin) { %>
					<button type="button" class="flex items-center border p-2 rounded-md" onclick="location.href='/admin-panel'"><img src="svg/adminPanelClicked.svg" alt="" class="pr-2">Admin Panel</button>
					<% } %>
				</div>
				
				<%- include("partials/FB-PhoneNumbers") %>
				
			</div>
			<!-- Modal -->
			<div class="demoModal hidden fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-black/30 transition-opacity duration-300 ease-in-out">
				<div class="relative w-full max-w-6xl p-4 transform scale-95 opacity-0 transition-all duration-300 ease-in-out modalContent">
					<!-- Close Button -->
					<div class="closeDemo absolute top-0 right-0 text-3xl text-white hover:cursor-pointer">&times;</div>
					
					<!-- Storylane Embed -->
					
					<script async src="https://js.storylane.io/js/v2/storylane.js"></script>
					<div class="sl-embed" style="position:relative;padding-bottom:calc(47.47% + 25px);width:100%;height:0;transform:scale(1)">
						<iframe loading="eager" class="sl-demo" src="https://app.storylane.io/demo/eubxsthobzcv?embed=inline" name="sl-embed" allow="fullscreen" allowfullscreen style="position:absolute;top:0;left:0;width:100%!important;height:100%!important;border:1px solid rgba(63,95,172,0.35);box-shadow: 0px 0px 18px rgba(26, 19, 72, 0.15);border-radius:10px;box-sizing:border-box;"></iframe>
						  
					</div>
					
				</div>
			</div>
			
			<!-- Statistics Cards -->
			<div class="grid-container pt-4">
				<div class="">
					<div class="border-gray-500 border card-dashboard">
						<h5>Messages Sent</h5>
						
						<div class="">
							<h4 class=""><%= messagesSent %></h4>
							<!-- <button type="button" onclick="viewSent()" class="border rounded-2xl px-3 py-1 shadow-sm text-sm h-fit">
								View user
							</button> -->
							<div class="absolute bottom-[-8rem] right-[-7rem] w-[200px] h-[200px]">
								<div class="absolute inset-0 rounded-full icon-gradient-sent"></div>
								<div class="absolute inset-8 rounded-full icon-gradient-sent"></div>
							</div>
							<img class="absolute bottom-3 right-3 " src="svg/singleTick.svg" alt="sent" />
						</div>
						
					</div>
				</div>
				
				<div class="">
					<div class="border-gray-500 border card-dashboard">
						<h5>Replies Received</h5>
						
						<div class="">
							<h4 class=""> <%= messagesReplied %></h4>
							<!-- <button type="button" onclick="viewReplied()" class="border rounded-2xl px-3 py-1 shadow-sm text-sm h-fit">
								View user
							</button> -->
							<div class="absolute bottom-[-8rem] right-[-7rem] w-[200px] h-[200px]">
								<div class="absolute inset-0 rounded-full icon-gradient-received"></div>
								<div class="absolute inset-8 rounded-full icon-gradient-received"></div>
							</div>
							<img class="absolute bottom-3 right-3" src="svg/arrow.svg" alt="sent" />
						</div>
					</div>
				</div>
				
				<div class="">
					<div class="border-gray-500 border card-dashboard">
						<h5>Messages Read</h5>
						
						<div class="">
							<h4 class=""><%= messagesRead %></h4>
							<!-- <button type="button" onclick="viewRead()" class="border rounded-2xl px-3 py-1 shadow-sm text-sm h-fit">
								View user
							</button> -->
							<div class="absolute bottom-[-8rem] right-[-7rem] w-[200px] h-[200px]">
								<div class="absolute inset-0 rounded-full icon-gradient-read"></div>
								<div class="absolute inset-8 rounded-full icon-gradient-read"></div>
							</div>
							<img class="absolute bottom-3 right-3" src="svg/tick.svg" alt="sent" />
						</div>
					</div>
				</div>
				
				<div class="">
					<div class="border-gray-500 border card-dashboard">
						<h5>Messages Delivered</h5>
						
						<div class="">
							<h4 class=""><%= messagesDelivered %></h4>
							<!-- <button type="button" onclick="viewDelivered()" class="border rounded-2xl px-3 py-1 shadow-sm text-sm h-fit">
								View user
							</button> -->
							<div class="absolute bottom-[-8rem] right-[-7rem] w-[200px] h-[200px]">
								<div class="absolute inset-0 rounded-full icon-gradient-delivered"></div>
								<div class="absolute inset-8 rounded-full icon-gradient-delivered"></div>
							</div>
							<img class="absolute bottom-3 right-3" src="svg/tick dark.svg" alt="sent" />
						</div>
					</div>
				</div>
				
				<div class="">
					<div class="border-gray-500 border card-dashboard">
						<h5>Messages Failed</h5>
						
						<div class="">
							<h4 class=""><%= messagesFailed %></h4>
							<!-- <button type="button" onclick="viewFailed()" class="border rounded-2xl px-3 py-1 shadow-sm text-sm h-fit">
								View user
							</button> -->
							<div class="absolute bottom-[-8rem] right-[-7rem] w-[200px] h-[200px]">
								<div class="absolute inset-0 rounded-full icon-gradient-failed"></div>
								<div class="absolute inset-8 rounded-full icon-gradient-failed"></div>
							</div>
							<img class="absolute bottom-3 right-3" src="svg/warning.svg" alt="sent" />
						</div>
					</div>
				</div>
				
				<div class="">
					<div class="border-gray-500 border card-dashboard">
						<h5>Approximate Cost</h5>
						
						<div class="">
							<span class="flex">
								<span class="self-end pr-2 pb-1"><%= user?.currency %></span>
								<h4 id="totalCost">0</h4>
							</span>
							<!-- <button type="button" onclick="viewFailed()" class="border rounded-2xl px-3 py-1 shadow-sm text-sm h-fit">
								View user
							</button> -->
							<!-- <div class="absolute bottom-[-8rem] right-[-7rem] w-[200px] h-[200px]">
								<div class="absolute inset-0 rounded-full icon-gradient-doesntExist"></div>
								<div class="absolute inset-8 rounded-full icon-gradient-doesntExist"></div>
							</div> -->
							<img class="absolute bottom-3 right-3" src="svg/User.svg" alt="sent" />
						</div>
					</div>
				</div>
			</div>
			<div class="">
				<!-- Quick Actions Section -->
				<h2 class="section-title">Quick Actions</h2>
				<div class="grid-container">
					<% const isPending = status === "Pending"; %>
					<% const isQuickActionsAllowed = access?.dashboard?.quickActions; %>
					
					<%- include('partials/featureBox', {
						title: 'Broadcast Messages',
						desc: 'Quickly send personalized updates or promotions to your audience at scale.',
						btnText: 'Send Now',
						href: '/contact-list/createCampaign',
						disabled: !isQuickActionsAllowed || isPending || !access?.contactList?.sendBroadcast,
						reason: !isQuickActionsAllowed
							? "You don't have permissions to access this"
							: isPending
							? "Connect with WhatsApp Business API to send message"
							: !access?.contactList?.sendBroadcast
							? "You don't have permissions to access this"
							: ""
					}) %>
					
					<%- include('partials/featureBox', {
						title: 'Create Template',
						desc: 'Design message templates for WhatsApp approval to streamline your communication.',
						btnText: 'Create Now',
						href: '/create-template',
						disabled: !isQuickActionsAllowed || isPending || !access?.templates?.createTemplate,
						reason: !isQuickActionsAllowed
							? "You don't have permissions to access this"
							: isPending
							? "Connect with WhatsApp Business API to send message"
							: !access?.templates?.createTemplate
							? "You don't have permissions to access this"
							: ""
					}) %>
					
					<%- include('partials/featureBox', {
						title: 'Import Contacts',
						desc: 'Upload your contact database',
						btnText: 'Import',
						href: '/contact-list',
						disabled: !isQuickActionsAllowed || isPending || !access?.contactList?.type,
						reason: !isQuickActionsAllowed
							? "You don't have permissions to access this"
							: isPending
							? "Connect with WhatsApp Business API to send message"
							: !access?.contactList?.type
							? "You don't have permissions to access this"
							: ""
					}) %>
				</div>
				
				<!-- Platform Features Section -->
				<h2 class="section-title">Platform Features</h2>
				<div class="grid-container">
					<!-- <div class="feature-box">
						<h3 class="feature-title">Automated Responses</h3>
						<p class="feature-description">Set up automated replies for common customer queries</p>
						<div class="icon-container">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" />
							</svg>
						</div>
					</div> -->
					
					<div class="feature-box relative overflow-hidden">
						<h3 class="feature-title">Bulk Messaging</h3>
						<p class="feature-description">Send messages to multiple contacts at once</p>
						<div class="w-full flex justify-end">
							<div class="mt-4">
								<div class="absolute bottom-[-9rem] right-[-8rem] w-[200px] h-[200px]">
									<div class="absolute inset-0 rounded-full icon-gradient-platform"></div>
									<div class="absolute inset-6 rounded-full icon-gradient-platform"></div>
								</div>
								<img class="absolute bottom-3 right-3" src="svg/bulk messaging.svg" alt="sent" />
								
							</div>
						</div>
					</div>
					
					<div class="feature-box relative overflow-hidden">
						<h3 class="feature-title">Analytics</h3>
						<p class="feature-description">Track message performance and customer engagement</p>
						<div class="w-full flex justify-end">
							<div class="mt-4">
								<div class="absolute bottom-[-9rem] right-[-8rem] w-[200px] h-[200px]">
									<div class="absolute inset-0 rounded-full icon-gradient-platform"></div>
									<div class="absolute inset-6 rounded-full icon-gradient-platform"></div>
								</div>
								<img class="absolute bottom-3 right-3" src="svg/analytics.svg" alt="sent" />
								
							</div>
						</div>
					</div>
					
					<div class="feature-box relative overflow-hidden">
						<h3 class="feature-title">Quick Replies</h3>
						<p class="feature-description">Create templates for frequently used messages</p>
						<div class="w-full flex justify-end">
							<div class="mt-4">
								<div class="absolute bottom-[-9rem] right-[-8rem] w-[200px] h-[200px]">
									<div class="absolute inset-0 rounded-full icon-gradient-platform"></div>
									<div class="absolute inset-6 rounded-full icon-gradient-platform"></div>
								</div>
								<img class="absolute bottom-3 right-3" src="svg/replies.svg" alt="sent" />
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<%- include('partials/filter-sidebar') %>
	
	<script>
		const app_id = <%- JSON.stringify(app) %>;
		const config_id = <%- JSON.stringify(config) %>;
		const graph_v = <%- JSON.stringify(graph) %>;
		const fbStatus = <%- JSON.stringify(status) %>;
		
		const element = document.querySelector(".gradient-button");
		
		let angle = 0;
		const rotateGradient = () => {
			angle = (angle + 5) % 360; // Increment angle and keep it within 0-360
			element.style.setProperty("--gradient-angle", `${angle}deg`);
			requestAnimationFrame(rotateGradient); // Smooth animation loop
		};
		
		rotateGradient();
	</script>
	<script src="assets/plugins/pace/pace.min.js" type="text/javascript"></script>
	<script src="https://kit.fontawesome.com/44e4e59292.js" crossorigin="anonymous"></script>
	<script src="/toast.js"></script>
	<script src="/menu.js"></script>
	<script src="/Dashboard/js/filter-sidebar.js"></script>
	<script src="/Dashboard/js/dashboard.js"></script>
	<!-- <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script> -->
	
</body>

</html>